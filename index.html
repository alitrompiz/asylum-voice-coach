<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AsylumPrep - AI Voice Coaching for Asylum Interviews</title>
    <meta name="description" content="Practice USCIS asylum interviews with AI-powered voice coaching. Build confidence and improve your skills with personalized feedback.">
    <meta name="author" content="AsylumPrep" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Manrope:wght@600;700;800&display=swap" rel="stylesheet">
    
    <link rel="preconnect" href="https://atthfkcmknkcyfeumcrq.supabase.co" crossorigin />

    
    
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
    <meta property="og:title" content="AsylumPrep - AI Voice Coaching for Asylum Interviews">
  <meta name="twitter:title" content="AsylumPrep - AI Voice Coaching for Asylum Interviews">
  <meta property="og:description" content="Practice USCIS asylum interviews with AI-powered voice coaching. Build confidence and improve your skills with personalized feedback.">
  <meta name="twitter:description" content="Practice USCIS asylum interviews with AI-powered voice coaching. Build confidence and improve your skills with personalized feedback.">
</head>

  <body>
    <noscript>
      <div style="padding:16px;font-family:system-ui,Arial;text-align:center;">
        This site requires JavaScript to run. Please enable JavaScript and reload.
      </div>
    </noscript>
    
    <!-- Boot rescue overlay -->
    <style>
      #boot-overlay{position:fixed;inset:0;background:#0b1220;color:#fff;display:flex;align-items:center;justify-content:center;font:600 16px/1.5 system-ui,Arial;z-index:2147483647}
      #boot-overlay.hidden{display:none}
    </style>
    <div id="boot-overlay">Loading AsylumPrepâ€¦</div>
    
    <!-- Pre-boot SW/caches purge for staging + mount watchdog + early error capture -->
    <script>
      (function(){
        const isStaging = location.hostname.endsWith('.lovable.app');
        
        // Early error capture - catch synchronous errors during module evaluation
        let earlyErrorCaught = false;
        
        const handleEarlyError = async (errorMsg) => {
          if (earlyErrorCaught) return;
          earlyErrorCaught = true;
          
          console.error('[Boot] Early error caught:', errorMsg);
          
          if (!sessionStorage.getItem('early-error-reload')) {
            sessionStorage.setItem('early-error-reload', '1');
            try {
              if ('serviceWorker' in navigator) {
                const regs = await navigator.serviceWorker.getRegistrations();
                await Promise.all(regs.map(r => r.unregister()));
              }
              if ('caches' in window) {
                const keys = await caches.keys();
                await Promise.all(keys.map(k => caches.delete(k)));
              }
            } catch (e) {}
            location.reload();
          } else {
            sessionStorage.removeItem('early-error-reload');
            const overlay = document.getElementById('boot-overlay');
            if (overlay) {
              overlay.innerHTML = '<div style="text-align:center;max-width:440px;padding:16px">' +
                '<div style="font-size:18px;font-weight:700;margin-bottom:8px">We couldn\'t start the app</div>' +
                '<div style="opacity:.8;margin-bottom:12px">Error: ' + errorMsg + '</div>' +
                '<div style="opacity:.8;margin-bottom:12px">Please click Reload. If this keeps happening, try another browser or contact support.</div>' +
                '<button onclick="location.reload()" style="background:#0ea5e9;color:#fff;border:none;border-radius:8px;padding:10px 14px;cursor:pointer;width:100%;font-weight:600">Reload</button>' +
                '</div>';
            }
          }
        };
        
        window.addEventListener('error', (e) => {
          handleEarlyError(e.message || 'Unknown error');
        });
        
        window.addEventListener('unhandledrejection', (e) => {
          handleEarlyError(e.reason?.message || 'Promise rejection');
        });
        
        // Initial SW/cache purge for staging
        if (isStaging && 'serviceWorker' in navigator) {
          navigator.serviceWorker.getRegistrations().then(rs => rs.forEach(r => r.unregister()));
        }
        if (isStaging && 'caches' in window) {
          caches.keys().then(keys => keys.forEach(k => caches.delete(k)));
        }
        
        // Mount watchdog: if app hasn't mounted in 6s, purge again and hard-reload once
        setTimeout(async () => {
          if (!window.__APP_MOUNTED__) {
            if (!sessionStorage.getItem('sw-rescue-reload')) {
              sessionStorage.setItem('sw-rescue-reload', '1');
              try {
                if ('serviceWorker' in navigator) {
                  const regs = await navigator.serviceWorker.getRegistrations();
                  await Promise.all(regs.map(r => r.unregister()));
                }
                if ('caches' in window) {
                  const keys = await caches.keys();
                  await Promise.all(keys.map(k => caches.delete(k)));
                }
              } catch (e) {}
              location.reload();
            } else {
              sessionStorage.removeItem('sw-rescue-reload');
              const overlay = document.getElementById('boot-overlay');
              if (overlay) {
                overlay.innerHTML = '<div style="text-align:center;max-width:440px;padding:16px">' +
                  '<div style="font-size:18px;font-weight:700;margin-bottom:8px">We couldn\'t start the app</div>' +
                  '<div style="opacity:.8;margin-bottom:12px">Please click Reload. If this keeps happening, try another browser or contact support.</div>' +
                  '<button onclick="location.reload()" style="background:#0ea5e9;color:#fff;border:none;border-radius:8px;padding:10px 14px;cursor:pointer;width:100%;font-weight:600">Reload</button>' +
                  '</div>';
              }
            }
          }
        }, 6000);
      })();
    </script>
    
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
